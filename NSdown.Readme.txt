NSdown::Transfer	[/METHOD GET|POST]
					/URL url
					[/LOCAL file|MEMORY|NONE]
					[/HEADERS hdr]
					[/DATA data | /DATAFILE file]
					[/TIMEOUTCONNECT msec] [/TIMEOUTRECONNECT msec]
					[/OPTCONNECTRETRIES count] [/OPTCONNECTTIMEOUT msec] [/OPTRECEIVETIMEOUT msec]
					[/PROXY server] [/PROXYUSER user] [/PROXYPASS pass]
					[/REFERER url]

/METHOD GET|POST			| HTTP Method. Default is GET
/URL url					| HTTP or HTTPS
/LOCAL file|MEMORY|NONE		| The remote content can be downloaded to either a local file, to memory, or not downloaded at all. Default is NONE
/HEADERS hdr				| Additional HTTP headers, separated by CRLF (\r\n)
/DATA data					| Additional data to be sent as part of the HTTP request
/DATAFILE file				| Additional data to be sent as part of the HTTP request (read from the specified file)
/TIMEOUTCONNECT msec		| Keep trying to connect for "msec" milliseconds. Default is 0 (only one attempt to connect is made)
/TIMEOUTRECONNECT msec		| Keep trying to reconnect for "msec" milliseconds, if the connection drops while downloading. Default is 0 (no attempts to reconnect are made)
/OPTCONNECTRETRIES count	| InternetSetOption( INTERNET_OPTION_CONNECT_RETRIES ). Relevant only for remote hosts with multiple IPs!
/OPTCONNECTTIMEOUT msec		| InternetSetOption( INTERNET_OPTION_CONNECT_TIMEOUT )
/OPTRECEIVETIMEOUT msec		| InternetSetOption( INTERNET_OPTION_RECEIVE_TIMEOUT )
/PROXY server				| Not implemented yet. The default proxy settings are used
/PROXYUSER user				| Not implemented yet. The default proxy settings are used
/PROXYPASS pass				| Not implemented yet. The default proxy settings are used
/REFERER url				| Optional referer URL, passed to InternetOpenRequest
/INTERNETFLAGS flags		| Combination of INTERNET_FLAG_XXX passed to InternetOpenRequest. Default is 0x84082200 (INTERNET_FLAG_NO_CACHE_WRITE|INTERNET_FLAG_IGNORE_CERT_DATE_INVALID|INTERNET_FLAG_NO_COOKIES|INTERNET_FLAG_NO_UI|INTERNET_FLAG_RELOAD)
/SECURITYFLAGS flags		| Combination of SECURITY_FLAG_XXX passed to InternetSetOption(INTERNET_OPTION_SECURITY_FLAGS). Default is 0x2080 (SECURITY_FLAG_IGNORE_REVOCATION|SECURITY_FLAG_IGNORE_CERT_DATE_INVALID)

Return:
	[Stack] An unique transfer ID. Useful to query the transfer status later

Examples:

	; Download to local file
	NSdown::Transfer /URL "http://live.sysinternals.com/Files/SysinternalsSuite.zip" /LOCAL "$EXEDIR\SysinternalsSuite.zip" /TIMEOUTCONNECT 60000 /TIMEOUTRECONNECT 300000
	Pop $0	; Transfer ID

	; Download to memory
	NSdown::Transfer /URL "http://live.sysinternals.com/Files/SysinternalsSuite.zip" /LOCAL MEMORY
	Pop $0	; Transfer ID

	; Send the HTTP request but don't download the content
	NSdown::Transfer /URL "http://mydomain.com:800?param1=va1&param2=val2" /LOCAL NONE
	Pop $0	; Transfer ID

	; POST a form
	NSdown::Transfer /METHOD POST /URL "http://httpbin.org/post" /LOCAL "Post.txt" /HEADERS "Content-Type: application/x-www-form-urlencoded" /DATA "user=MY+NAME&pass=MY+PASSWORD"
	Pop R0	; Transfer ID
_________________________________________________________________________________________________

NSdown::QueryGlobal

Return:
	[Stack] Worker thread count
	[Stack] ItemsTotal (representing ItemsDone + ItemsDownloading + ItemsWaiting)
	[Stack] ItemsDone
	[Stack] ItemsDownloading
	[Stack] ItemsWaiting
	[Stack] Combined speed of transfers in progress (in bytes/s)

Example:
	NSdown::QueryGlobal
	Pop $R0 ; Worker threads
	Pop $R1 ; ItemsTotal
	Pop $R2 ; ItemsDone
	Pop $R3 ; ItemsDownloading
	Pop $R4 ; ItemsWaiting
	Pop $R5 ; Speed bps

	; Format $R5 (b/s) -> $R6 (KB/s, MB/s, ...)
!ifdef NSIS_UNICODE
	System::Call 'shlwapi::StrFormatByteSizeW( l r15, t .r16, i ${NSIS_MAX_STRLEN} ) p'
!else
	System::Call 'shlwapi::StrFormatByteSizeA( i r15, t .r16, i ${NSIS_MAX_STRLEN} ) p'
!endif

	DetailPrint "Transferring $R2+$R3/$R1 items at $R6/s by $R0 worker threads"
_________________________________________________________________________________________________

TODO:
* Parameterized InternetOpenUrl flags
* Parameterized HttpSendRequest flags
- Proxy
* reconnect during dld
* Connect timeout parameter
* Reconnect timeout parameter
x resume parameter
* query file size
* download file with unknown size
- HTTPS authentication
- PROXY authentication
- GET/POST/PUT(WebDAV)
* POST headers
- Multiple download sources
* Support files > 4GB
- Support destination folder only. Use the filename from HTTP_QUERY_CONTENT_DISPOSITION (ex: piriform downloads)
- Use InternetSetStatusCallback
- Retry opening local file if ERROR_LOCK_VIOLATION
- Measure transfer speed
- Save the raw headers and make it available to NSIS script (support HEAD method)
- Enumerate transfers in queue
- Pause/Resume transfer. Create paused
- Cancel transfer
- Queue priorities
- Attach the "Zone.Identifier" stream
- Resume memory downloads as well
